from(bucket: "mybucket")
  |> range(start: 2021-01-01T00:00:00Z, stop: 2024-01-01T06:00:00Z)
  |> filter(fn: (r) => r["_measurement"] == "query_1")
  |> filter(fn: (r) => r["country"] == "Italy" or r["country"] == "Sweden")
  |> filter(fn: (r) => r["_field"] == "carbon-mean" or r["_field"] == "carbon-min" or r["_field"] == "carbon-max")
  |> aggregateWindow(every: 1m, fn: mean, createEmpty: false)
  |> yield(name: "mean")

from(bucket: "mybucket")
  |> range(start: 2021-01-01T00:00:00Z, stop: 2024-01-01T06:00:00Z)
  |> filter(fn: (r) => r["_measurement"] == "query_1")
  |> filter(fn: (r) => r["country"] == "Italy" or r["country"] == "Sweden")
  |> filter(fn: (r) => r["_field"] == "cfe-max" or r["_field"] == "cfe-mean" or r["_field"] == "cfe-min")
  |> aggregateWindow(every: 1m, fn: mean, createEmpty: false)
  |> yield(name: "mean")

from(bucket: "mybucket")
  |> range(start: 2021-01-01T00:00:00Z, stop: 2024-01-01T06:00:00Z)
  |> filter(fn: (r) => r["_measurement"] == "query_2")
  |> filter(fn: (r) => r["_field"] == "carbon-intensity")
  |> aggregateWindow(every: 1d, fn: mean, createEmpty: false)
  |> yield(name: "mean")

from(bucket: "mybucket")
  |> range(start: 2021-01-01T00:00:00Z, stop: 2024-01-01T06:00:00Z)
  |> filter(fn: (r) => r["_measurement"] == "query_2")
  |> filter(fn: (r) => r["_field"] == "cfe")
  |> aggregateWindow(every: 1d, fn: mean, createEmpty: false)
  |> yield(name: "mean")